{% extends 'base.html' %} 

{% block contenido %}
  <div class="container-lg py-5 my-5">
    <div class="row">
      <div class="col-lg-12 my-6 py-5">
        <h3>Carga de Resultados</h3>
        <div id="accordion">
          <!--FILTRO-->
            <form method="GET">
              <input type="number" name="filtro1">
              <button type="submit">filtrar por id de Solicitud</button>
            </form>
            <form method="GET">
              <input type="number" name="filtro2">
              <button type="submit">filtrar por dni</button>
            </form>
            <!--FIN FILTRO-->

            {% if dni %}

             <h1> FUNCIONA {{dni}}</h1>


            {% endif%}


            {% for p in solicitudes %} 
              
                    <div class="card my-4">
                        <div class="card-header bg-light" id="heading_{{p.id}}">
                          <h5 class="mb-0">
                              <button class="btn btn-link" data-toggle="collapse" data-target="#collapse_{{p.id}}"  aria-expanded="false" aria-controls="collapse_{{p.id}}">
                              Solicitud de: {{p.usuario}} |  Fecha de creacion: {{p.fecha_creacion}}
                              </button>
                          </h5>
                        </div>
                        <div
                        id="collapse_{{p.id}}"
                        class="collapse"
                        aria-labelledby="heading_{{p.id}}"
                        data-parent="#accordion"
                        >
                          <div class="card-body">
                            <h4 class="text">Numero solicitud: {{p.id}}</h4>
                            <h6 class="text"><b>Usuario:</b> {{p.usuario}}</h6>
                            <h6 class="text"><b>Dni:</b> {{p.usuario.dni}}</h6>
                            <h6 class="text"><b>Domicilio</b> {{p.usuario.domicilio}}</h6>
                              {% if p.estado == 1 %}
                                {% if p.fecha_hisopado %}
                                  <h6 class="text"><b>Estado:</b>Hisopado asignado</h6>
                                  <h6 class="text"><b>Fecha de hisopado:</b>{{p.fecha_hisopado}}</h6>
                                {% else %}
                                  <h6 class="text"><b>Estado:</b>En espera de asignacion de turno</h6>
                                  <h6 class="text"><b>Fecha de hisopado:</b>En espera de asignacion de fecha</h6>
                                {% endif %}
                              {% elif p.estado == 2 %}
                                <h6 class="text"><b>Estado:</b>Hisopado realizado, en espera de resultado</h6>
                                <h6 class="text"><b>Fecha de hisopado:</b>{{p.fecha_hisopado}}</h6>
                                <h6 class="text"><b>Resultado:</b>En espera..</h6>
                              {% else %}
                                <h6 class="text"><b>Estado:</b>Realizado</h6>
                                <h6 class="text"><b>Fecha de hisopado:</b>{{p.fecha_hisopado}}</h6>
                                {% if p.resultado %}
                                  <h6 class="text"><b>Resultado:</b>Positivo COVID-19</h6>
                                {% else %}
                                  <h6 class="text"><b>Resultado:</b>Negativo COVID-19</h6>
                                {% endif %}
                              {% endif %} 
                              <button type="button" class="btn btn-primary" onclick="location.href='{% url 'Autotest:modificar' p.id %}'">Cargar Resultado </button>
                        </div>
                        </div>
                    </div>
                
                
            {% endfor %}
      
        </div>
      </div>
    </div>
  </div>
{% endblock %}